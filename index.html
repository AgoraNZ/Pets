<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Saskia's Ark - Modern Marketplace</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    /* Base styles */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Roboto', sans-serif; background: #f2f2f2; color: #333; }
    a { text-decoration: none; color: inherit; }
    
    /* Header & Navigation */
    header {
      background: #0073e6;
      color: #fff;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header h1 { font-size: 1.8em; }
    nav a, nav button {
      margin: 0 8px;
      font-weight: 500;
      color: #fff;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1em;
    }
    nav a:hover, nav button:hover { text-decoration: underline; }
    
    /* Slider */
    .slider {
      position: relative;
      width: 100%;
      height: 400px;
      overflow: hidden;
    }
    .slide {
      position: absolute;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
    .slide.active { opacity: 1; }
    .slide img { width: 100%; height: 100%; object-fit: cover; }
    
    /* Main content */
    main { padding: 20px; }
    
    /* Listings Grid */
    .listing-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    .listing-card {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.3s;
    }
    .listing-card:hover { transform: translateY(-5px); }
    .listing-card img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }
    .listing-info {
      padding: 15px;
    }
    .listing-info h3 { font-size: 1.2em; margin-bottom: 8px; }
    .listing-info p { font-size: 0.9em; line-height: 1.4; }
    .listing-info .price {
      color: #0073e6;
      font-weight: bold;
      margin-top: 10px;
    }
    .listing-info .seller {
      font-style: italic;
      margin-top: 5px;
      font-size: 0.85em;
    }
    
    /* Detail Page */
    .detail-container {
      background: #fff;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s;
    }
    .detail-image {
      width: 100%;
      height: 400px;
      object-fit: cover;
      border-bottom: 1px solid #ddd;
      margin-bottom: 20px;
    }
    .ask-btn {
      background: #0073e6;
      color: #fff;
      border: none;
      padding: 10px 15px;
      font-size: 1em;
      cursor: pointer;
      border-radius: 3px;
      margin-top: 15px;
    }
    .ask-btn:hover { background: #005bb5; }
    
    /* Footer */
    footer {
      text-align: center;
      padding: 15px;
      font-size: 0.8em;
      color: #777;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Saskia's Ark</h1>
    <nav>
      <a href="#home">Home</a>
      <a href="#sell">Sell a Pet</a>
      <a href="#upload">Super Buyer Upload</a>
      <span id="authLinks">
        <a href="#login" id="loginLink">Login</a>
        <a href="#register" id="registerLink">Register</a>
      </span>
      <button id="logoutBtn" style="display:none;">Logout</button>
    </nav>
  </header>
  
  <!-- Slider Section -->
  <div class="slider" id="slider">
    <div class="slide active">
      <img src="https://images.unsplash.com/photo-1558788353-f76d92427f16?auto=format&fit=crop&w=1200&h=400" alt="Golden Retriever">
    </div>
    <div class="slide">
      <img src="https://images.unsplash.com/photo-1573694847310-c0f7bb1aa744?auto=format&fit=crop&w=1200&h=400" alt="Labrador Retriever">
    </div>
    <div class="slide">
      <img src="https://images.unsplash.com/photo-1592194996308-7b43878e84a6?auto=format&fit=crop&w=1200&h=400" alt="Siamese Cat">
    </div>
    <div class="slide">
      <img src="https://images.unsplash.com/photo-1560114924-ef19c34a30c3?auto=format&fit=crop&w=1200&h=400" alt="British Shorthair">
    </div>
  </div>
  
  <main>
    <div id="content"></div>
    <!-- Listings Grid -->
    <div class="listing-grid" id="listingGrid"></div>
  </main>
  
  <footer>
    &copy; 2025 Pet TradeMe. All rights reserved.
  </footer>
  
  <script>
    // --- Slider Functionality ---
    const slides = document.querySelectorAll('.slide');
    let currentSlide = 0;
    setInterval(() => {
      slides[currentSlide].classList.remove('active');
      currentSlide = (currentSlide + 1) % slides.length;
      slides[currentSlide].classList.add('active');
    }, 4000);
    
    // --- LocalStorage Persistence Functions ---
    function getUsers() {
      return JSON.parse(localStorage.getItem("users") || "[]");
    }
    function saveUsers(users) {
      localStorage.setItem("users", JSON.stringify(users));
    }
    function getPets() {
      return JSON.parse(localStorage.getItem("pets") || "[]");
    }
    function savePets(pets) {
      localStorage.setItem("pets", JSON.stringify(pets));
    }
    function getCurrentUser() {
      const userId = localStorage.getItem("currentUser");
      if (!userId) return null;
      return getUsers().find(u => u.id === userId);
    }
    function setCurrentUser(userId) {
      localStorage.setItem("currentUser", userId);
    }
    function clearCurrentUser() {
      localStorage.removeItem("currentUser");
    }
    function generateId() {
      return '_' + Math.random().toString(36).substr(2, 9);
    }
    
    // --- Navigation & Routing ---
    function updateNav() {
      const currentUser = getCurrentUser();
      document.getElementById("loginLink").style.display = currentUser ? "none" : "inline";
      document.getElementById("registerLink").style.display = currentUser ? "none" : "inline";
      document.getElementById("logoutBtn").style.display = currentUser ? "inline" : "none";
    }
    document.getElementById("logoutBtn").addEventListener("click", () => {
      clearCurrentUser();
      window.location.hash = "#home";
      render();
    });
    
    function render() {
      const hash = window.location.hash || "#home";
      const content = document.getElementById("content");
      content.innerHTML = "";
      updateNav();
      if (hash === "#home") {
        renderHome();
      } else if (hash === "#login") {
        renderLogin();
      } else if (hash === "#register") {
        renderRegister();
      } else if (hash === "#sell") {
        renderSellPet();
      } else if (hash === "#upload") {
        renderUpload();
      } else if (hash.startsWith("#pet-")) {
        const petId = hash.slice(5);
        renderPetDetail(petId);
      } else {
        content.innerHTML = "<p>Page not found.</p>";
      }
    }
    window.addEventListener("hashchange", render);
    
    // --- Views ---
    function renderHome() {
      const content = document.getElementById("content");
      content.innerHTML = "<h2>Featured Listings</h2>";
      renderListings();
    }
    
    function renderLogin() {
      const content = document.getElementById("content");
      content.innerHTML = `
        <h2>Login</h2>
        <form id="loginForm">
          <label>Email: <input type="email" name="email" required></label>
          <label>Password: <input type="password" name="password" required></label>
          <button type="submit">Login</button>
        </form>
        <div id="loginError" style="color:red;"></div>
      `;
      document.getElementById("loginForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const email = e.target.email.value;
        const password = e.target.password.value;
        const users = getUsers();
        const user = users.find(u => u.email === email && u.password === password);
        if (user) {
          setCurrentUser(user.id);
          window.location.hash = "#home";
          render();
        } else {
          document.getElementById("loginError").innerText = "Invalid credentials";
        }
      });
    }
    
    function renderRegister() {
      const content = document.getElementById("content");
      content.innerHTML = `
        <h2>Register</h2>
        <form id="registerForm">
          <label>Username: <input type="text" name="username" required></label>
          <label>Email: <input type="email" name="email" required></label>
          <label>Password: <input type="password" name="password" required></label>
          <button type="submit">Register</button>
        </form>
        <div id="registerError" style="color:red;"></div>
      `;
      document.getElementById("registerForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const username = e.target.username.value;
        const email = e.target.email.value;
        const password = e.target.password.value;
        const users = getUsers();
        if (users.find(u => u.email === email)) {
          document.getElementById("registerError").innerText = "User already exists";
          return;
        }
        const newUser = { 
          id: generateId(), 
          username, 
          email, 
          password, 
          superBuyer: false, 
          propertyPhoto: null 
        };
        users.push(newUser);
        saveUsers(users);
        setCurrentUser(newUser.id);
        window.location.hash = "#home";
        render();
      });
    }
    
    function renderSellPet() {
      const currentUser = getCurrentUser();
      if (!currentUser) {
        window.location.hash = "#login";
        render();
        return;
      }
      const content = document.getElementById("content");
      content.innerHTML = `
        <h2>Sell a Pet</h2>
        <form id="sellForm">
          <label>Title: <input type="text" name="title" required></label>
          <label>Type: <input type="text" name="type" required></label>
          <label>Breed: <input type="text" name="breed"></label>
          <label>Age: <input type="number" name="age"></label>
          <label>Description:<br><textarea name="description"></textarea></label>
          <label>Price: <input type="number" name="price" required></label>
          <!-- For simplicity, seller image is pre-populated in sample listings -->
          <button type="submit">Create Listing</button>
        </form>
        <div id="sellError" style="color:red;"></div>
      `;
      document.getElementById("sellForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const pet = {
          id: generateId(),
          title: e.target.title.value,
          type: e.target.type.value,
          breed: e.target.breed.value,
          age: e.target.age.value,
          description: e.target.description.value,
          price: e.target.price.value,
          sellerId: currentUser.id,
          image: "https://source.unsplash.com/random/300x200" // fallback image
        };
        const pets = getPets();
        pets.push(pet);
        savePets(pets);
        window.location.hash = "#home";
        render();
      });
    }
    
    function renderUpload() {
      const currentUser = getCurrentUser();
      if (!currentUser) {
        window.location.hash = "#login";
        render();
        return;
      }
      const content = document.getElementById("content");
      content.innerHTML = `
        <h2>Super Buyer Qualification</h2>
        <p>Upload a photo of your property so sellers can see where the pet will be going.</p>
        <form id="uploadForm">
          <input type="file" name="photo" accept="image/*" required><br>
          <button type="submit">Upload Photo</button>
        </form>
        <div id="uploadMsg"></div>
      `;
      document.getElementById("uploadForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const fileInput = e.target.photo;
        const file = fileInput.files[0];
        const reader = new FileReader();
        reader.onload = function(event) {
          let users = getUsers();
          const userIndex = users.findIndex(u => u.id === currentUser.id);
          if (userIndex !== -1) {
            users[userIndex].propertyPhoto = event.target.result;
            users[userIndex].superBuyer = true;
            saveUsers(users);
            document.getElementById("uploadMsg").innerText = "Upload successful! You are now a Super Buyer.";
          }
        }
        reader.readAsDataURL(file);
      });
    }
    
    function renderPetDetail(petId) {
      const content = document.getElementById("content");
      const pets = getPets();
      const pet = pets.find(p => p.id === petId);
      if (!pet) {
        content.innerHTML = "<p>Listing not found.</p>";
        return;
      }
      const users = getUsers();
      const seller = users.find(u => u.id === pet.sellerId) || { username: "Sample Seller" };
      content.innerHTML = `
        <div class="detail-container">
          <img class="detail-image" src="${pet.image || 'https://source.unsplash.com/featured/800x400/?'+pet.type}" alt="${pet.title}">
          <h2>${pet.title}</h2>
          <p><strong>Type:</strong> ${pet.type}</p>
          <p><strong>Breed:</strong> ${pet.breed}</p>
          <p><strong>Age:</strong> ${pet.age}</p>
          <p><strong>Description:</strong> ${pet.description}</p>
          <p class="price"><strong>Price:</strong> \$${pet.price}</p>
          <p class="seller"><strong>Seller:</strong> ${seller.username}</p>
          <button class="ask-btn" onclick="askSeller('${seller.username}')">Ask Seller a Question</button>
          <p><a href="#home">Back to Listings</a></p>
        </div>
      `;
    }
    
    // Simulate asking seller a question
    function askSeller(sellerName) {
      const question = prompt("Enter your question for " + sellerName + ":");
      if (question) {
        alert("Your question has been sent to " + sellerName + ":\n\n" + question);
      }
    }
    
    // --- Pre-populate 20 Sample Listings (if none exist) ---
    function populateSampleListings() {
      if(getPets().length > 0) return; // Do not overwrite existing listings
      const sampleListings = [
        {
          id: generateId(),
          title: "Golden Retriever",
          type: "Dog",
          breed: "Golden Retriever",
          age: 3,
          description: "Friendly, loyal and energetic. Perfect for families.",
          price: 600,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1558788353-f76d92427f16?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Labrador Retriever",
          type: "Dog",
          breed: "Labrador",
          age: 4,
          description: "Labrador with a playful spirit and gentle nature.",
          price: 650,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1573694847310-c0f7bb1aa744?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Siamese Cat",
          type: "Cat",
          breed: "Siamese",
          age: 2,
          description: "Elegant and talkative, a charming companion.",
          price: 300,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1592194996308-7b43878e84a6?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Persian Cat",
          type: "Cat",
          breed: "Persian",
          age: 3,
          description: "Fluffy, calm, and affectionate—ideal for indoor living.",
          price: 350,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1601758124327-2b3bdb1b45b4?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "British Shorthair",
          type: "Cat",
          breed: "British Shorthair",
          age: 3,
          description: "Calm, loyal and independent with a plush coat.",
          price: 320,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1560114924-ef19c34a30c3?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Rex Rabbit",
          type: "Rabbit",
          breed: "Rex",
          age: 1,
          description: "Soft and cuddly, perfect for petting and playtime.",
          price: 90,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1598511728182-27d7f90345f9?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Lop Rabbit",
          type: "Rabbit",
          breed: "Lop",
          age: 1,
          description: "Adorable lop-eared rabbit with a sweet temperament.",
          price: 85,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1612817150060-6ec8cc4d89e4?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Netherland Dwarf Guinea Pig",
          type: "Guinea Pig",
          breed: "Netherland Dwarf",
          age: 1,
          description: "Small, energetic and perfect for first-time owners.",
          price: 45,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1610917629193-b3cc35647b5e?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "American Guinea Pig",
          type: "Guinea Pig",
          breed: "American",
          age: 1,
          description: "Friendly and curious with a soft, cuddly coat.",
          price: 50,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1610917629200-c3cc35647b6f?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Border Collie",
          type: "Dog",
          breed: "Border Collie",
          age: 2,
          description: "Smart, energetic and ideal for active families.",
          price: 500,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1598133894002-28390ff9e888?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Bulldog",
          type: "Dog",
          breed: "Bulldog",
          age: 3,
          description: "Strong, gentle and with a distinctive personality.",
          price: 450,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1583511655612-b72f8a3f6e9a?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Maine Coon",
          type: "Cat",
          breed: "Maine Coon",
          age: 4,
          description: "Large, majestic and known for its friendly nature.",
          price: 400,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1592194996308-5b43878e84a6?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Sphynx Cat",
          type: "Cat",
          breed: "Sphynx",
          age: 2,
          description: "Distinctive, affectionate and with a unique look.",
          price: 380,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1592194996308-6b43878e84a6?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Beagle",
          type: "Dog",
          breed: "Beagle",
          age: 3,
          description: "Small, energetic and known for its friendly nature.",
          price: 320,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1575936123452-b67c3203c357?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "German Shepherd",
          type: "Dog",
          breed: "German Shepherd",
          age: 4,
          description: "Loyal, protective and intelligent—a true working dog.",
          price: 550,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1568572933382-74d440642117?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Abyssinian Cat",
          type: "Cat",
          breed: "Abyssinian",
          age: 3,
          description: "Active, playful and with a striking coat pattern.",
          price: 330,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1583336660823-19f1218b3b2e?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Dutch Rabbit",
          type: "Rabbit",
          breed: "Dutch",
          age: 1,
          description: "Distinctive markings and a gentle, curious nature.",
          price: 95,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1598511728255-42cf1fbb1c80?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Flemish Giant Rabbit",
          type: "Rabbit",
          breed: "Flemish Giant",
          age: 2,
          description: "Huge and gentle—needs plenty of space to roam.",
          price: 120,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1601758125000-2e3bdb1b45f5?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Crested Guinea Pig",
          type: "Guinea Pig",
          breed: "Crested",
          age: 1,
          description: "Small, active and with a distinctive crest of hair.",
          price: 55,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1610917629300-d3cc35647b7a?auto=format&fit=crop&w=300&h=200"
        },
        {
          id: generateId(),
          title: "Dwarf Rabbit",
          type: "Rabbit",
          breed: "Dwarf",
          age: 1,
          description: "Compact and adorable with a lively personality.",
          price: 80,
          sellerId: "sample_seller",
          image: "https://images.unsplash.com/photo-1601758125100-2e3bdb1b45f6?auto=format&fit=crop&w=300&h=200"
        }
      ];
      savePets(sampleListings);
    }
    
    // Render listings grid
    function renderListings() {
      populateSampleListings();
      const listingsContainer = document.getElementById("listingGrid");
      const listings = getPets();
      listingsContainer.innerHTML = "";
      listings.forEach(listing => {
        const card = document.createElement("div");
        card.className = "listing-card";
        card.innerHTML = `
          <img src="${listing.image}" alt="${listing.title}">
          <div class="listing-info">
            <h3>${listing.title}</h3>
            <p>${listing.description}</p>
            <p class="price">\$${listing.price}</p>
            <p class="seller">Seller: ${listing.sellerId}</p>
          </div>
        `;
        card.addEventListener("click", () => {
          window.location.hash = "#pet-" + listing.id;
          render();
        });
        listingsContainer.appendChild(card);
      });
    }
    
    render();
  </script>
</body>
</html>
